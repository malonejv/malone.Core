name: Deploy Workflow
description: Deploy application

inputs:
   nuget_source:
     required: true
     default: ''
   nuget_username:
     required: true
     default: ''
   nuget_password:
     required: true
     default: ''
   pack_artifact_name:
     required: true
     default: 'pack-artifacts'
   package_pattern:
     required: true
     default: ''
   symbol_pattern:
     required: false
     default: ''
     
runs:
  using: "composite"

  steps: 
  
  - name: Add GitHub as Nuget Source
    shell: pwsh
    run: nuget sources add -name "github" -Source ${{ inputs.nuget_source }} -Username ${{ inputs.nuget_username }} -Password ${{ inputs.nuget_password }}
    
  - name: Download packed artifacts
    uses: actions/download-artifact@v2
    with:
        name: "${{ inputs.pack_artifact_name }}"
        path: "${{ inputs.pack_artifact_name }}"

  - name: "Push Nuget Packages"
    shell: pwsh
    run: |
          cd "${{ github.workspace }}\\${{ inputs.pack_artifact_name }}"
          nuget push "${{ inputs.package_pattern }}" -SkipDuplicate -source "github"
          if("${{ inputs.symbol_pattern }}"-ne""){ nuget push "${{ inputs.symbol_pattern }}" -SkipDuplicate -source "github"}
